  <!DOCTYPE html>
  <html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>20-10 üíå</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: radial-gradient(ellipse at center, #000011 0%, #000000 100%);
        font-family: 'Times New Roman', Times, serif;
        user-select: none;
        perspective: 1000px;
      }

      /* üå∏ B√¥ng hoa v√† v√≤m k√≠nh */
      .flower__wrapper {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 4vh 22vh;
        border-radius: 50% 50% 0 0;
        background: linear-gradient(#fff8fb -100%, transparent);
        overflow: hidden;
        box-shadow: 0 0 50px rgba(255, 200, 255, 0.4);
        cursor: pointer;
      }

      .flower__wrapper:before {
        content: "";
        position: absolute;
        top: 4%;
        left: 4%;
        width: 92%;
        height: 96%;
        background: radial-gradient(circle at top left, #fff -800%, transparent);
        border-radius: 50% 50% 0 0;
      }

      .flower__wrapper:after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at top left, #fff -800%, transparent);
      }

      /* === B√¥ng hoa === */
      .flower {
          display: flex;
          flex-direction: column-reverse;
          align-items: center;
      }
      .flower__sparkles {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
      }
      .flower__sparkle {
          position: absolute;
          width: 5px;
          height: 5px;
          background: linear-gradient(#FFF, #F5FCCD);
          box-shadow: 0 0 20px 10px rgba(255, 255, 255, 0.5);
          border-radius: 50%;
      }
      .flower__sparkle:nth-child(1) { top: 10%; left: 40%; }
      .flower__sparkle:nth-child(2) { top: 25%; left: 20%; }
      .flower__sparkle:nth-child(3) { top: 40%; left: 30%; }
      .flower__sparkle:nth-child(4) { top: 50%; left: 10%; }
      .flower__sparkle:nth-child(5) { top: 80%; right: 30%; }
      .flower__sparkle:nth-child(6) { top: 70%; left: 20%; }
      .flower__sparkle:nth-child(7) { top: 60%; right: 20%; }
      .flower__sparkle:nth-child(8) { top: 35%; right: 20%; }

      .flower__head {
          position: relative;
          display: flex;
          justify-content: center;
          width: 15vh;
          height: 15vh;
          margin-bottom: -10vh;
          transform: rotateX(75deg);
      }
      .flower__petal {
          position: absolute;
          bottom: 40%;
          width: 15vh;
          height: 15vh;
      }
      .flower__petal:after {
          content: "";
          position: relative;
          top: 0rem;
          left: 60%;
          display: block;
          width: 2px;
          height: 80%;
          background: #F5FCCD;
          transform: rotate(45deg);
      }
      .flower__petal--left {
          left: -50%;
          border-radius: 0 50% 40% 50%;
          background: linear-gradient(135deg, #F5FCCD, #ff7d66);
          transform-origin: 100% 100%;
      }
      .flower__petal--left:after {
          left: unset;
          right: -40%;
          transform: rotate(135deg);
      }
      .flower__petal--right {
          right: -50%;
          border-radius: 50% 0 50% 40%;
          background: linear-gradient(-135deg, #F5FCCD, #ff7d66);
          transform-origin: 0 100%;
      }
      .flower__petal--front {
          transform: scaleY(-1);
      }
      .flower__center {
          position: relative;
          width: 100%;
          height: 100%;
          background: linear-gradient(#ff7d66, #eb80b1);
          border-radius: 50% 50% 35% 35%;
      }
      .flower__seeds {
          position: absolute;
          bottom: 2vh;
          left: 0;
          width: 100%;
          height: 100%;
          margin-bottom: 3vh;
      }
      .flower__seed {
          position: absolute;
          width: 3px;
          height: 3px;
          border-radius: 50%;
          background-color: #FFF;
      }
      .flower__seed:nth-child(1) { top: 60%; left: 40%; }
      .flower__seed:nth-child(2) { top: 40%; left: 60%; }
      .flower__seed:nth-child(3) { top: 50%; left: 50%; }
      .flower__seed:nth-child(4) { top: 60%; left: 60%; }
      .flower__seed:nth-child(5) { top: 40%; left: 40%; }
      .flower__seed:nth-child(6) { top: 50%; left: 30%; }
      .flower__seed:nth-child(7) { top: 30%; left: 50%; }
      .flower__seed:nth-child(8) { top: 70%; left: 50%; }
      .flower__seed:nth-child(9) { top: 50%; left: 70%; }

      .flower__steam-wrapper {
          position: relative;
          width: 2.2vh;
          height: 50vh;
      }
      .flower__leaf {
          position: absolute;
          width: 350%;
          height: 15%;
          background: #80c0a1;
          border-radius: 50% 0 50% 0;
      }
      .flower__leaf--first {
          bottom: 25%;
          left: 100%;
          background: linear-gradient(-135deg, #80c0a1, #F5FCCD);
          transform-origin: -10%;
      }
      .flower__leaf--second {
          top: 30%;
          right: 100%;
          background: linear-gradient(45deg, #80c0a1, #F5FCCD);
          transform: scaleY(-1);
          transform-origin: 110%;
          z-index: 1;
      }
      .flower__steam {
          position: relative;
          width: 95%;
          height: 90%;
          background: linear-gradient(#000038, #80c0a1, #F5FCCD);
          border-radius: 0 0 1rem 0;
          overflow: hidden;
      }
      .flower__steam-end {
          position: absolute;
          bottom: 0;
          width: 100%;
          height: 4vh;
          background: linear-gradient(#ff7d66, #F5FCCD);
          border-radius: 50% 20% 50% 0;
      }

      /* üå† N·ªÅn sao + hi·ªáu ·ª©ng ch√≠nh */
      #galaxy, #rotatingContainer {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
      }

      #rotatingContainer { z-index: 2; }
      #galaxy { z-index: 1; }

      /* ‚úâÔ∏è Thi·ªáp */
      #card {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        transition: transform 0.8s ease-in-out;
        z-index: 5;
        transform-style: preserve-3d;
        display: none;
        animation: float 3s ease-in-out infinite;
      }

      @keyframes float {
        0%, 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        50% { transform: translate(-50%, -52%) scale(1.03) rotate(1deg); }
      }

      #card img {
        width: 700px;
        height: auto;
        display: block;
        backface-visibility: hidden;
        transition: transform 1s ease, filter 1s ease, opacity 1s ease;
      }

      .open-animation {
        animation: glowZoom 3s ease-in-out forwards;
      }

      @keyframes glowZoom {
        0% {
          opacity: 0;
          transform: scale(0.9);
          filter: brightness(0.6);
        }
        50% {
          opacity: 1;
          transform: scale(1.05);
          filter: brightness(1.2) drop-shadow(0 0 20px rgba(255,150,255,0.8));
        }
        100% {
          transform: scale(1);
          filter: brightness(1);
        }
      }

      /* üí¨ Text */
      #text {
        position: absolute;
        top: 37%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 380px;
        color: #b2003a;
        font-size: 22px;
        line-height: 1.4;
        text-align: center;
        font-weight: bold;
        opacity: 0;
        z-index: 6;
        text-shadow: 0 0 5px #fff3f6;
        white-space: pre-line;
      }

      .text-glow {
        animation: glowText 2s infinite ease-in-out alternate;
      }

      @keyframes glowText {
        from { text-shadow: 0 0 5px #ff9ad9, 0 0 10px #fff; }
        to { text-shadow: 0 0 15px #ffb6e6, 0 0 25px #fff; }
      }

      .text-particle, .image-particle {
        position: absolute;
        will-change: transform, opacity;
        pointer-events: none;
      }

      .text-particle {
        white-space: nowrap;
        text-shadow: 0 0 12px rgba(255,255,255,0.8);
        color: #ff7487;
      }

      .image-particle {
        max-width: 50px;
        max-height: 50px;
        border-radius: 5px;
        filter: drop-shadow(0 0 4px #fff);
      }
    </style>
  </head>
  <body>
    <!-- üå∏ B√¥ng hoa m·ªü ƒë·∫ßu -->
    <div id="flowerWrapper" class="flower__wrapper">
      <div class="flower__sparkles">
        <div class="flower__sparkle"></div>
        <div class="flower__sparkle"></div>
        <div class="flower__sparkle"></div>
        <div class="flower__sparkle"></div>
        <div class="flower__sparkle"></div>
        <div class="flower__sparkle"></div>
        <div class="flower__sparkle"></div>
        <div class="flower__sparkle"></div>
      </div>
      <div class="flower">
        <div class="flower__steam-wrapper">
          <div class="flower__leaf flower__leaf--first"></div>
          <div class="flower__leaf flower__leaf--second"></div>
          <div class="flower__steam">
            <div class="flower__steam-end"></div>
          </div>
        </div>
        <div class="flower__head flower__head--main">
          <div class="flower__petal flower__petal--back flower__petal--left flower__petal--back-left"></div>
          <div class="flower__petal flower__petal--back flower__petal--right flower__petal--back-right"></div>
          <div class="flower__petal flower__petal--front flower__petal--left flower__petal--front-left"></div>
          <div class="flower__petal flower__petal--front flower__petal--right flower__petal--front-right"></div>
          <div class="flower__center">
            <div class="flower__seeds">
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
              <div class="flower__seed"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>

    <!-- üå† Hi·ªáu ·ª©ng ch√≠nh (·∫©n ban ƒë·∫ßu) -->
    <div id="galaxy"></div>
    <div id="rotatingContainer"></div>
    <div id="card">
      <img id="cardImage" src="thu3.png" alt="Thi·ªáp 20-10" />
    </div>
    <div id="text"></div>

    <script>
      const flowerWrapper = document.getElementById("flowerWrapper");
      const rotatingContainer = document.getElementById('rotatingContainer');
      const galaxy = document.getElementById('galaxy');
      const card = document.getElementById('card');
      const cardImage = document.getElementById('cardImage');
      const text = document.getElementById('text');

      let music;

      // üå∏ M·ªü k√≠nh
      flowerWrapper.addEventListener("click", openDome);

      function openDome() {
        flowerWrapper.style.pointerEvents = "none";
        gsap.to(flowerWrapper, {
          y: -500,
          scale: 1.05,
          rotateX: 25,
          opacity: 0,
          duration: 3,
          ease: "power2.inOut",
          onComplete: () => {
            startMainScene();
          }
        });
      }

      // üöÄ Ph·∫ßn hi·ªáu ·ª©ng ch√≠nh
      function startMainScene() {
        flowerWrapper.style.display = "none";
        card.style.display = "block";
        startStars();
        loopParticles();

        music = new Audio('./e.mp3');
        music.loop = true;
        music.play().catch(() => console.log("Kh√¥ng th·ªÉ ph√°t nh·∫°c t·ª± ƒë·ªông."));

        initCardAnimation();
      }

      // ‚úâÔ∏è Hi·ªáu ·ª©ng thi·ªáp
      function initCardAnimation() {
    const message = `Ch√∫c b·∫°n m·ªôt ng√†y 20/10 th·∫≠t h·∫°nh ph√∫c üíñ
  Lu√¥n xinh ƒë·∫πp, d·ªãu d√†ng v√† t·ªèa s√°ng nh∆∞ ch√≠nh b·∫°n üå∏`;
    
    let opened = false;      // tr·∫°ng th√°i thi·ªáp
    let typingFinished = true; // kh√≥a click khi text ch∆∞a xong
    let typingTimeouts = []; // l∆∞u c√°c timeout ƒë·ªÉ clear n·∫øu c·∫ßn

    function showTextTypewriter(msg) {
      text.textContent = "";
      text.style.opacity = 1;
      text.classList.add("text-glow");
      let i = 0;
      typingFinished = false;

      function typing() {
        if (i < msg.length) {
          text.textContent += msg[i];
          i++;
          const t = setTimeout(typing, 40);
          typingTimeouts.push(t);
        } else {
          typingFinished = true; // m·ªü kh√≥a khi g√µ xong
        }
      }
      typing();
    }

    function toggleCard() {
      if (!typingFinished) return; // n·∫øu text ch∆∞a xong th√¨ kh√¥ng click ƒë∆∞·ª£c

      card.style.animation = 'none';
      cardImage.style.transition = 'transform 0.6s ease, filter 0.6s ease, opacity 0.6s ease';

      // Quay thi·ªáp 90 ƒë·ªô
      cardImage.style.transform = 'rotateY(90deg)';

      setTimeout(() => {
        if (!opened) {
          cardImage.src = 'thu4.png';
          showTextTypewriter(message);
          card.style.animation = 'none'; // reset animation
        } else {
          cardImage.src = 'thu3.png';
          text.style.opacity = 0;
          text.textContent = '';
          text.classList.remove("text-glow");

          // B·∫≠t l·∫°i animation float + glowZoom
          card.style.animation = 'float 3s ease-in-out infinite';
          card.classList.add("open-animation"); // n·∫øu mu·ªën glowZoom
        }

        cardImage.style.transform = 'rotateY(0deg)';
        opened = !opened;
      }, 300);
    }

    // click + touch cho mobile
    card.addEventListener('click', toggleCard);
    card.addEventListener('touchstart', toggleCard);
  }

      // üåå N·ªÅn sao 3D
      function startStars() {
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 150;

        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x000000, 0);
        galaxy.appendChild(renderer.domElement);

        const starsCount = 600;
        const positions = new Float32Array(starsCount * 3);
        for (let i = 0; i < starsCount; i++) {
          positions[i * 3] = (Math.random() - 0.5) * 400;
          positions[i * 3 + 1] = (Math.random() - 0.5) * 400;
          positions[i * 3 + 2] = (Math.random() - 0.5) * 400;
        }

        const geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

        const starTexture = new THREE.TextureLoader().load('https://threejs.org/examples/textures/sprites/disc.png');
        const material = new THREE.PointsMaterial({
          color: 0xffffff,
          size: 0.5,
          map: starTexture,
          transparent: true,
          alphaTest: 0.2,
          depthWrite: false
        });

        const stars = new THREE.Points(geometry, material);
        scene.add(stars);

        function animate() {
          stars.rotation.y += 0.0008;
          renderer.render(scene, camera);
          requestAnimationFrame(animate);
        }
        animate();
      }

      // üéá Particles
      const messages = ["20-10", "Happy Vietnamese Women's Day üíñ", "Lu√¥n Xinh ƒê·∫πp", "H·∫°nh Ph√∫c"];
      const imageURLs = ["download.jpg"];
      const icons = ["‚ù§Ô∏è", "‚ù§", "üíó"];
      const maxParticles = 120;
      const activeParticles = new Set();

      function createParticle(type = 'text') {
        if (activeParticles.size >= maxParticles) return;
        const el = type === 'text' ? document.createElement('div') : document.createElement('img');
        if (type === 'text') {
          const isIcon = Math.random() < 0.3;
          el.className = 'text-particle';
          el.textContent = isIcon ? icons[Math.floor(Math.random() * icons.length)] : messages[Math.floor(Math.random() * messages.length)];
          el.style.fontSize = (isIcon ? 20 : 18) + Math.random() * 10 + 'px';
        } else {
          el.className = 'image-particle';
          el.src = imageURLs[Math.floor(Math.random() * imageURLs.length)];
        }
        el.style.opacity = 0;
        rotatingContainer.appendChild(el);

        const w = el.offsetWidth || 40;
        el.style.left = Math.random() * (window.innerWidth - w) + 'px';

        const z = -Math.random() * 300;
        const startY = -50;
        const endY = window.innerHeight + 50;
        const duration = 7000 + Math.random() * 4000;
        const t0 = performance.now();

        function animate(t) {
          const p = (t - t0) / duration;
          if (p >= 1) {
            el.remove();
            activeParticles.delete(el);
          } else {
            const y = startY + p * (endY - startY);
            const op = p < 0.1 ? p * 10 : (p > 0.9 ? (1 - p) * 10 : 1);
            el.style.opacity = op;
            el.style.transform = `translate3d(0, ${y}px, ${z}px)`;
            requestAnimationFrame(animate);
          }
        }

        activeParticles.add(el);
        requestAnimationFrame(animate);
      }

      function loopParticles() {
        let last = 0;
        function tick(t) {
          if (t - last > 300) {
            createParticle('text');
            if (Math.random() < 0.5) createParticle('image');
            last = t;
          }
          requestAnimationFrame(tick);
        }
        requestAnimationFrame(tick);
      }

      const sparklesTl = gsap.timeline({repeat: -1});

          sparklesTl.to('.flower__sparkle:nth-child(3n)', { y: 10, opacity: 0.5, duration: 2})
          sparklesTl.to('.flower__sparkle:nth-child(3n-1)', { y: -5, opacity: 0.8, duration: 2, delay: -2})
          sparklesTl.to('.flower__sparkle:nth-child(3n-2)', { y: 5, opacity: 0.3, duration: 2, delay: -2})
          sparklesTl.to('.flower__sparkle:nth-child(3n)', { y: -10, opacity: 0.8, duration: 2})
          sparklesTl.to('.flower__sparkle:nth-child(3n-1)', { y: 10, opacity: 0.6, duration: 2, delay: -2})
          sparklesTl.to('.flower__sparkle:nth-child(3n-2)', { y: 10, opacity: 0.3, duration: 2, delay: -2})
          sparklesTl.to('.flower__sparkle', { y: 0, opacity: 0.5, duration: 2})

          const flowerTl = gsap.timeline({repeat: -1});

          flowerTl.to('.flower', {y: 20, duration: 3})
          flowerTl.to('.flower', {y: 0, duration: 3})
          flowerTl.to('.flower__head', {rotateX: '70deg', duration: 3, delay: -6});
          flowerTl.to('.flower__head', {rotateX: '75deg', duration: 3, delay: -3});

          const petalsTl = gsap.timeline({repeat: -1});

          petalsTl.to('.flower__petal--back-left', { rotateZ: '-90deg', ease: 'linear', duration: 3})
          petalsTl.to('.flower__petal--back-right', { rotateZ: '-90deg', ease: 'linear', duration: 3, delay: -3})
          petalsTl.to('.flower__petal--front-left', { rotateZ: '-90deg', ease: 'linear', duration: 3, delay: -3})
          petalsTl.to('.flower__petal--front-right', { rotateZ: '-90deg', ease: 'linear', duration: 3, delay: -3})

          const steamTl = gsap.timeline({repeat: -1});

          steamTl.to('.flower__seeds', {rotateZ: '-360deg', ease: 'linear', duration: 12})
          steamTl.to('.flower__leaf--first', {rotateY: '-360deg', zIndex: 1, ease: 'linear', duration: 12, delay: -12})
          steamTl.to('.flower__leaf--second', {rotateY: '360deg', zIndex: 0, ease: 'linear', duration: 12, delay: -12})
          steamTl.to('.flower__steam-end', {x: '100%', rotateY: '90deg', ease: 'linear', duration: 3, delay: -12})
          steamTl.from('.flower__steam-end', {x: '-100%', rotateY: '-90deg', ease: 'linear', duration: 3, delay: -3})

          const leafShadowTl = gsap.timeline({repeat: -1})

          leafShadowTl.fromTo('.flower__leaf--first', {filter: 'brightness(1)'}, {filter: 'brightness(0.5)', duration: 3})
          leafShadowTl.to('.flower__leaf--first', {filter: 'brightness(1)', duration: 3})
          leafShadowTl.fromTo('.flower__leaf--second', {filter: 'brightness(1)'}, {filter: 'brightness(0.5)', duration: 3})
          leafShadowTl.to('.flower__leaf--second', {filter: 'brightness(1)', duration: 3})
    </script>
  </body>
  </html>
